# Поиск изображений по описанию

Задача: разработать Proof of Concept версию поиска изображений по запросу.

## Данные
Train:
1000 изображений

Test:
100 изображений

Для каждого изображения доступно до 5 описаний. 
И оценки соответствия описания изображению от 3 экспертов и крауда.  

**Как собирались данные?**

Экспертам и крауду были показаны изображения и их описания. Часть описаний соответствовало изображениям, часть - нет.

3 эксперта каждый выставляли оценку от 1 до 4, где   
* 1 — изображение и запрос совершенно не соответствуют друг другу,   
* 2 — запрос содержит элементы описания изображения, но в целом запрос тексту не соответствует,   
* 3 — запрос и текст соответствуют с точностью до некоторых деталей,   
* 4 — запрос и текст соответствуют полностью.

Оценки крауда включают в себя:
* Доля людей, подтвердивших, что описание соответствует изображению.
* Количество человек, подтвердивших, что описание соответствует изображению.
* Количество человек, подтвердивших, что описание не соответствует изображению.

**Дополнительное условие:**  
Необходимо исключить из обучающей выборки изображения детей младше 16 лет.

А при попытке найти такие изображения вместо картинок должен показываться дисклеймер:

> This image is unavailable in your country in compliance with local laws
> 

## Модель

Модель должна на входе получать эмбединги изображения и запроса, а на выходе предоставлять значение от 0 до 1 - вероятность соответствия запроса и изображению.

Обычно эта задача решается кодированием одного эмбединга в другой (напр. эмбединга картинки в эмбединг запроса), по которому происходит поиск с помощью измерения расстояния между векторами и поиска наиболее близких. Но в качестве тренировки использовали подход регрессии. 

Метрика: `MSE`.

Были обучены линейная регрессия, и нейронная сеть.

Конечно, на таком небольшом объеме датасета качественную модель не обучить, поэтому в дополнение была протестирована модель Open AI CLIP, которая, ожидаемо, показала отличные результаты.

